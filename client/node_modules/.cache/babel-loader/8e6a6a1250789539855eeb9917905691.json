{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mustafamustafa/Desktop/MERN_GoogleBooks-main/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mustafamustafa/Desktop/MERN_GoogleBooks-main/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mustafamustafa/Desktop/MERN_GoogleBooks-main/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import SearchBar from\"../components/SearchBar/SearchBar\";import Results from\"../components/Results/Results\";import BookCardSearched from\"../components/BookCard/BookCardSearched\";import API from\"../utils/API\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SearchPage=function SearchPage(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),search=_useState2[0],setSearch=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),results=_useState4[0],setResults=_useState4[1];var handleInputChange=function handleInputChange(event){setSearch(event.target.value);};var handleFormSubmit=function handleFormSubmit(event){event.preventDefault();API.getBook(search).then(function(res){console.log(res.data.items);var bookFields=res.data.items.map(function(item){var thumbnail=item.volumeInfo.imageLinks?item.volumeInfo.imageLinks.thumbnail:\"\";return{id:item.id,title:item.volumeInfo.title,authors:item.volumeInfo.authors,description:item.volumeInfo.description,image:thumbnail,link:item.volumeInfo.infoLink};});console.log(bookFields);setResults(bookFields);});setSearch(\"\");};// Makes the API call to save a book to our db\nvar saveBook=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var newBook,bookList,i;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();newBook={apiId:event.target.dataset.id,title:event.target.dataset.title,authors:event.target.dataset.authors,description:event.target.dataset.description,image:event.target.dataset.image,link:event.target.dataset.link};console.log(newBook);_context.next=5;return getSavedBooks();case 5:bookList=_context.sent;// Checks to see if book is already saved and alerts the user if so\nconsole.log(\"Book count: \".concat(bookList.length));i=0;case 8:if(!(i<bookList.length)){_context.next=16;break;}console.log(bookList[i].apiId);if(!(bookList[i].apiId===newBook.apiId)){_context.next=13;break;}alert(\"Book is already saved!\");return _context.abrupt(\"return\");case 13:i++;_context.next=8;break;case 16:API.saveBook(newBook).then(function(res){return console.log(res);}).catch(function(err){return console.log(err);});;case 18:case\"end\":return _context.stop();}}},_callee);}));return function saveBook(_x){return _ref.apply(this,arguments);};}();var getSavedBooks=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return API.getBooks();case 3:res=_context2.sent;return _context2.abrupt(\"return\",res.data);case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);return _context2.abrupt(\"return\");case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,7]]);}));return function getSavedBooks(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(SearchBar,{handleInputChange:handleInputChange,handleFormSubmit:handleFormSubmit,searchInput:search}),results.length?/*#__PURE__*/_jsx(Results,{children:results.map(function(item){var authors=item.authors?item.authors.join(\", \"):\"\";return/*#__PURE__*/_jsx(BookCardSearched,{id:item.id,title:item.title,authors:authors,description:item.description,image:item.image,link:item.link,saveBook:saveBook},item.id);})}):/*#__PURE__*/_jsx(\"p\",{})]});};export default SearchPage;","map":{"version":3,"sources":["/Users/mustafamustafa/Desktop/MERN_GoogleBooks-main/client/src/pages/SearchPage.js"],"names":["React","useState","SearchBar","Results","BookCardSearched","API","SearchPage","search","setSearch","results","setResults","handleInputChange","event","target","value","handleFormSubmit","preventDefault","getBook","then","res","console","log","data","items","bookFields","map","item","thumbnail","volumeInfo","imageLinks","id","title","authors","description","image","link","infoLink","saveBook","newBook","apiId","dataset","getSavedBooks","bookList","length","i","alert","catch","err","getBooks","join"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport SearchBar from \"../components/SearchBar/SearchBar\";\nimport Results from \"../components/Results/Results\";\nimport BookCardSearched from \"../components/BookCard/BookCardSearched\";\nimport API from \"../utils/API\";\n\nconst SearchPage = () => {\n    const [search, setSearch] = useState(\"\")\n    const [results, setResults] = useState([])\n\n\n    const handleInputChange = event => {\n        setSearch(event.target.value)\n    }\n\n    const handleFormSubmit = event => {\n        event.preventDefault();\n      \n\n        API.getBook(search)\n            .then(res => {\n                console.log(res.data.items);\n\n                const bookFields = res.data.items.map(item => {\n                    let thumbnail = (item.volumeInfo.imageLinks) ? item.volumeInfo.imageLinks.thumbnail : \"\";\n\n                    return {\n                        id: item.id,\n                        title: item.volumeInfo.title,\n                        authors: item.volumeInfo.authors,\n                        description: item.volumeInfo.description,\n                        image: thumbnail,\n                        link: item.volumeInfo.infoLink\n                    }\n                })\n\n                console.log(bookFields);\n\n                setResults(bookFields)\n            })\n\n            setSearch(\"\")\n    }\n\n    // Makes the API call to save a book to our db\n    const saveBook = async (event) => {\n        event.preventDefault();\n\n        let newBook = {\n            apiId: event.target.dataset.id,\n            title: event.target.dataset.title,\n            authors: event.target.dataset.authors,\n            description: event.target.dataset.description,\n            image: event.target.dataset.image,\n            link: event.target.dataset.link\n        }\n\n        console.log(newBook)\n\n        const bookList = await getSavedBooks();\n\n        // Checks to see if book is already saved and alerts the user if so\n        console.log(`Book count: ${bookList.length}`)\n        for (let i = 0; i < bookList.length; i++) {\n            console.log(bookList[i].apiId)\n            if (bookList[i].apiId === newBook.apiId) {\n                alert(\"Book is already saved!\")\n                return;\n            }\n        }\n\n        API.saveBook(newBook)\n            .then(res =>\n                console.log(res)\n            )\n            .catch(err => console.log(err));;\n    }\n\n    const getSavedBooks = async () => {\n        try {\n            const res = await API.getBooks()\n            return res.data;\n        } catch (err) {\n            console.log(err);\n            return;\n        }\n    };\n\n    return (\n        <>\n            <SearchBar\n                handleInputChange={handleInputChange}\n                handleFormSubmit={handleFormSubmit}\n                searchInput={search}\n            />\n\n            {results.length ? (\n                <Results>\n                    {results.map((item) => {\n                       \n                        let authors = (item.authors) ? item.authors.join(\", \") : \"\";\n\n                        return <BookCardSearched\n                            id={item.id}\n                            key={item.id}\n                            title={item.title}\n                            authors={authors}\n                            description={item.description}\n                            image={item.image}\n                            link={item.link}\n                            saveBook={saveBook}\n                        />\n                    }\n                    )}\n                </Results>\n            ) : (\n                   <p></p>\n                )}\n        </>\n    )\n}\n\nexport default SearchPage;"]},"metadata":{},"sourceType":"module"}